name: Keep N8N Alive

on:
  schedule:
    # Ejecutar cada 5 minutos para mantener N8N siempre activo
    - cron: '*/5 * * * *'
  workflow_dispatch: # Permite ejecutar manualmente

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping N8N Webhook
        run: |
          echo "ğŸš€ Haciendo ping a N8N en Render..."
          response=$(curl -s -o /dev/null -w "%{http_code}" https://n8n-bot-inmobiliario.onrender.com/)
          echo "ğŸ“¡ Status Code: $response"
          if [ $response -eq 200 ] || [ $response -eq 404 ]; then
            echo "âœ… N8N estÃ¡ activo"
          else
            echo "âš ï¸ N8N respondiÃ³ con cÃ³digo: $response"
          fi

      - name: Ping Webhook Chat
        run: |
          echo "ğŸ”” Verificando endpoint del webhook..."
          curl -X GET https://n8n-bot-inmobiliario.onrender.com/webhook/chat || echo "âš ï¸ Endpoint no responde a GET (normal)"
